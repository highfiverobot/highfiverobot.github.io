<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV Data Table</title>
    <!-- Tailwind CSS CDN for basic styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Light gray background */
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Align to top */
            min-height: 100vh;
            padding: 2rem;
        }
        .container {
            background-color: #ffffff;
            padding: 2.5rem;
            border-radius: 1rem; /* Rounded corners */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* Subtle shadow */
            width: 100%;
            max-width: 960px; /* Max width for readability */
            overflow-x: auto; /* Enable horizontal scrolling for wide tables */
        }
        table {
            width: 100%;
            border-collapse: separate; /* Allows border-radius on cells */
            border-spacing: 0;
            border-radius: 0.5rem; /* Rounded corners for the table */
            overflow: hidden; /* Ensures content respects border-radius */
        }
        th, td {
            padding: 1rem 1.5rem;
            text-align: left;
            border-bottom: 1px solid #e5e7eb; /* Light gray border */
        }
        th {
            background-color: #4f46e5; /* Indigo 600 */
            color: #ffffff;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-size: 0.875rem; /* sm text */
        }
        tr:last-child td {
            border-bottom: none; /* No border for the last row */
        }
        tbody tr:hover {
            background-color: #eff6ff; /* Light blue on hover */
        }
        .loading-message {
            text-align: center;
            padding: 2rem;
            font-size: 1.125rem; /* lg text */
            color: #6b7280; /* Gray 500 */
        }
        .error-message {
            text-align: center;
            padding: 2rem;
            font-size: 1.125rem; /* lg text */
            color: #ef4444; /* Red 500 */
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">CSV Data Display</h1>
        <div id="table-container" class="loading-message">
            Loading data...
        </div>
    </div>

    <!-- Papa Parse CDN for easy CSV parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

    <script>
        // Function to fetch CSV data and render it as an HTML table
        async function loadCsvData() {
            const tableContainer = document.getElementById('table-container');
            const csvFilePath = '_trade_have.csv'; // Updated CSV file path

            console.log('Attempting to load CSV data from:', csvFilePath); // Log 1

           // try {
                // Fetch the CSV file
                const response = await fetch(csvFilePath);
                console.log('Fetch response received:', response); // Log 2

                // Check if the fetch was successful
                if (!response.ok) {
                    console.error('HTTP error! Status:', response.status, 'Status Text:', response.statusText); // Log 3
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                // Get the text content of the CSV file
                const csvText = await response.text();
                console.log('CSV text content fetched:', csvText.substring(0, 200) + '...'); // Log 4 (first 200 chars)

                // Use Papa Parse to parse the CSV text
                PapaParse.parse(csvText, {
                    header: false, // Set to false because the CSV does not have a header row
                    skipEmptyLines: true, // Ignore empty rows
                    complete: function(results) {
                        const data = results.data;
                        const errors = results.errors;

                        console.log('Papa Parse results:', results); // Log 5
                        console.log('Parsed data:', data); // Log 6
                        console.log('Parsing errors:', errors); // Log 7

                        if (errors.length > 0) {
                            console.error("CSV Parsing Errors:", errors);
                            tableContainer.innerHTML = `<div class="error-message">Error parsing CSV: ${errors[0].message}</div>`;
                            return;
                        }

                        if (data.length === 0) {
                            tableContainer.innerHTML = `<div class="loading-message">No data found in CSV.</div>`;
                            return;
                        }

                        // Create the table element
                        const table = document.createElement('table');
                        table.classList.add('min-w-full', 'divide-y', 'divide-gray-200', 'shadow-sm', 'rounded-lg');

                        // Create table header (thead)
                        const thead = document.createElement('thead');
                        const headerRow = document.createElement('tr');
                        
                        // Generate generic headers if no header row is present
                        // Get the number of columns from the first data row
                        const numColumns = data[0].length;
                        for (let i = 0; i < numColumns; i++) {
                            const th = document.createElement('th');
                            th.textContent = `Column ${i + 1}`; // e.g., Column 1, Column 2
                            headerRow.appendChild(th);
                        }
                        thead.appendChild(headerRow);
                        table.appendChild(thead);

                        // Create table body (tbody)
                        const tbody = document.createElement('tbody');
                        tbody.classList.add('bg-white', 'divide-y', 'divide-gray-200');

                        // Loop through the data rows
                        data.forEach(rowData => {
                            const tr = document.createElement('tr');
                            // Loop through the values for each row (rowData is now an array)
                            rowData.forEach(cellData => {
                                const td = document.createElement('td');
                                td.textContent = cellData || ''; // Use || '' to handle undefined values gracefully
                                tr.appendChild(td);
                            });
                            tbody.appendChild(tr);
                        });
                        table.appendChild(tbody);

                        // Clear loading message and append the table
                        tableContainer.innerHTML = '';
                        tableContainer.appendChild(table);
                        console.log('Table rendered successfully.'); // Log 8
                    }
                });

          //  } catch (error) {
          //      console.error('Error loading CSV data in catch block:', error); // Log 9
          //      tableContainer.innerHTML = `<div class="error-message">Failed to load CSV data. Please check the file path and network connection.</div>`;
          //  }
        }

        // Call the function when the DOM is fully loaded
        document.addEventListener('DOMContentLoaded', loadCsvData);
    </script>
</body>
</html>
